#include "nlibrary.fz"

function fold5 
  (v : num) (g: num -o num -o M[eps64_up]num)
  (l3 : num -o (num -o num -o M[eps64_up]num) -o M[1.34e-15]num)
        : M[1.34e-15]num {
  (l3 v) g
}

function list4 (as : (num,(num,(num,(num,num))))) :
  num -o (num -o num -o (M[eps64_up]num)) -o M[1.34e-15]num
{
  let (a0,as1) = as ; let (a1,as2) = as1;
  let (a2,as3) = as2; let (a3,a4) = as3;
  fun (n : num) {fun (c : num -o (num -o M[eps64_up]num))
                  { let z5 = (c a4) n;
                    let z4 = (c a3) z5;
                    let z3 = (c a2) z4;
                    let z2 = (c a1) z3;
                    (c a0) z2
                  }
                }
}

function Horner5_HO (as : (num,(num,(num,(num,(num,num))))))
        (x : num) : M[1.34e-15]num {
  g = fun (a: num) {fun (b: num) {((FMA b) x) a}};
  let (a0,as') = as; 
  l = (list4 as');
  ((fold5 a0) g) l
}


fold5
